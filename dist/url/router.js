define("#mix/core/0.3.0/url/router",["mix/core/0.3.0/base/reset","mix/core/0.3.0/base/class","mix/core/0.3.0/base/message"],function(a,b,c){a("mix/core/0.3.0/base/reset");var d=a("mix/core/0.3.0/base/class"),e=a("mix/core/0.3.0/base/message"),g=window,i=(g.document,g.location);g.Router;var k=d.create({Implements:e,initialize:function(){var a=this;e.prototype.initialize.call(a,"router"),a._handlers=[],a._options={},a._changeHanlder=a._changeHanlder.bind(a)},_getHash:function(){return i.hash.slice(1)||""},_setHash:function(a){i.hash=a},_resetHandler:function(){var a=this,b=a._handlers;Object.each(b,function(a){a.matched=!1})},_changeHanlder:function(){var b=this;b._resetHandler(),b.match()},start:function(a){var b=this;return k.started?!1:(g.addEventListener("hashchange",b._changeHanlder,!1),k.started=!0,Object.extend(b._options,a||{}),b.match(),!0)},stop:function(){var a=this;return k.started?(g.removeEventListener("hashchange",a._changeHanlder,!1),k.started=!1,a._options={},a._handlers=[],!0):!1},match:function(){var c,d,a=this,b=a._handlers;if(k.started){d=a._fragment=a._getHash();for(var e=0;b.length>e;e++)if(c=b[e],!c.matched&&c.route.test(d)&&(c.matched=!0,c.callback(d),c.last))return}},add:function(a,b,c){var d=this,e=d._handlers;e.push({route:a,callback:b,matched:!1,last:!!c})},remove:function(a,b){for(var c=this,d=c._handlers,e=0;d.length>e;e++){var f=d[e];if(f.route.source===a.source&&(!b||f.callback===b))return d.splice(e,1)}},navigate:function(a){var a,c=this;k.started&&(a||(a=""),c._fragment!==a&&c._setHash(a))}});k.started=!1,k.singleton=new k,c.exports=k});