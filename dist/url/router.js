define("#mix/core/0.3.0/url/router",["mix/core/0.3.0/base/reset","mix/core/0.3.0/base/class"],function(a,b,c){a("mix/core/0.3.0/base/reset");var d=a("mix/core/0.3.0/base/class"),e=requite("message"),f=window,h=(f.document,f.location);f.Router;var j=d.create({Implements:e,initialize:function(){var a=this;e.prototype.initialize.call(a,"navigate"),a._handlers=[],a._options={},a._changeHanlder=a._changeHanlder.bind(a)},_getHash:function(){return h.hash.slice(1)||""},_setHash:function(a){h.hash=a},_resetHandler:function(){var a=this,b=a._handlers;Object.each(b,function(a){a.matched=!1})},_changeHanlder:function(){var a=this;a._resetHandler(),a.match()},start:function(a){var b=this;return j.started?!1:(j.started=!0,f.addEventListener("hashchange",b._changeHanlder,!1),a=Object.extend(b._options,a||{}),a.firstMatch!==!1&&b.match(),!0)},stop:function(){var a=this;return j.started?(f.removeEventListener("hashchange",a._changeHanlder,!1),j.started=!1,a._options={},a._handlers=[],a._fragment=null,!0):!1},match:function(){var a=this;if(a._,handlers=a._handlers,unmatched=!0,j.started){fragment=a._fragment=a._getHash();for(var c=0;handlers.length>c&&(handler=handlers[c],handler.matched||!handler.route.test(fragment)||(unmatched=!0,handler.matched=!0,handler.callback(fragment),!handler.last));c++);unmatched&&a.trigger("unmatched",fragment)}},add:function(a,b,c){var d=this,e=d._handlers;e.push({route:a,callback:b,matched:!1,last:!!c})},remove:function(a,b){for(var c=this,d=c._handlers,e=0;d.length>e;e++){var f=d[e];if(f.route.source===a.source&&(!b||f.callback===b))return d.splice(e,1)}},navigate:function(a){var a,b=this;j.started&&(a||(a=""),b._fragment!==a&&b._setHash(a))}});j.started=!1,j.singleton=new j,c.exports=j});