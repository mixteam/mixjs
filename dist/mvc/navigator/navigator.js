define("#mix/core/0.3.0/mvc/navigator/navigator",["mix/core/0.3.0/base/reset","mix/core/0.3.0/base/class","mix/core/0.3.0/mvc/controller"],function(a,b,c){function d(a,b,c){var d="controller-js-"+a;return m[d]||(script=j.createElement("script"),script.id=d,script.type="text/javascript",script.async=!0,script.onload=script.onreadystatechange=function(){m[d]||(m[d]=script,c&&c())},script.src=b,k.appendChild(script)),d}function e(a,b){var c="controller-js-"+a,d=m[c];return d&&(k.removeChild(m[c]),delete m[c],b&&b()),c}function f(a){return a?function(){var b=this,c=arguments;o?a.apply(b,c):p.push(function(){a.apply(b,c)})}:void 0}function g(){if(!o){for(;p.length;)handler=p.shift(),handler();o=!0}}a("mix/core/0.3.0/base/reset");var h=(a("mix/core/0.3.0/base/class"),a("mix/core/0.3.0/mvc/controller")),i=window,j=i.document,k=j.head,l=void 0,m={},n=h.extend({initialize:function(){var a=this,b={historyEvents:{"navigator:forward":f(a._forwardHandler),"navigator:backward":f(a._backwardHandler)}};n.superclass.initialize.call(a,"navigatorController",b),a._queue=[],a._limit=6,a._index=-1,a._controllers={},a._viewName=l},_forwardHandler:function(a,b){var c,d,e=this,f=e._controllers,g=e._queue,h=e._limit,i=e._index,j=g[i];i===h-1?(d=g.shift(),g.push(!!0)):i++,c=g[i],c!==a&&(g[i]=a,g.splice(i+1)),d&&0>g.indexOf(d)&&e.removeController(d),e._index=i,e.trigger("forward",a),f[a]?e.activeController(a):e.addController(a,b),f[j]&&e.suspendController(j)},_backwardHandler:function(a,b){var c,d,e=this,f=e._controllers,g=e._queue,h=(e._limit,e._index),i=g[h];if(0===h?(d=g.pop(),g.unshift(!!0)):h--,c=g[h],c!==a){g[h]=a;for(var j=0;h>j;j++)g[j]=!!0}d&&0>g.indexOf(d)&&e.removeController(d),e._index=h,e.trigger("backward",a),f[a]?e.activeController(a):e.addController(a,b),f[i]&&e.suspendController(i)},addController:function(a,b,c){var e=this,f=e._controllers,g=f[a];g||(e._controllers[a]="loading",d(a,b,c))},depositController:function(a,b,c){var d,e=this,f=e._controllers,c=Array.make(arguments).slice(2);return d=new h(a,{routes:b}),Object.each(c,function(a){d.addView(a)}),f[a]=d,d},activeController:function(a){var b=this,c=b._controllers,d=c[a];d&&d.trigger&&d.trigger("active")},suspendController:function(a){var b=this,c=b._controllers,d=c[a];d&&d.trigger&&d.trigger("suspend")},removeController:function(a){var b=this,c=b._controllers,d=Object.isTypeof(a,"string")?a:a.getName(),a=c[d];a&&(e(d),a.trigger&&a.trigger("destroy"),c[d]=null,delete c[d])},getController:function(a){var b=this;return b._controllers[a]},setView:function(a){var b=this;o=!1,b._viewName=n.superclass.addView.call(b,a),b.getView().once("ready",g)},getView:function(){var a=this;return n.superclass.getView.call(a,a._viewName)}}),o=!0,p=[];n.singleton=new n,c.exports=n});