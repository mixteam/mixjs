define("#mix/core/0.3.0/ui/template/template",["mix/core/0.3.0/base/reset","mix/core/0.3.0/base/class","mix/libs/handlebars/1.0.5/handlebars"],function(a,b,c){a("mix/core/0.3.0/base/reset");var d=a("mix/core/0.3.0/base/class"),e=a("mix/libs/handlebars/1.0.5/handlebars"),f=window,g=f.document,h=d.create({initialize:function(a,b,c){var d=this;d._id=h.id(),d._name=a||"template"+d._id,d._type=b||"template",d._root=c||"root",d._helpers={},d._partials={},d._chunks={},d._html="",d._nodeList=[]},_init:function(){var a=this;a._helpers=Object.extend(a._helpers,e.helpers),a._partials=Object.extend(a._partials,e.partials),h.helpers(a),h.partials(a),h.chunks(a)},addHelper:function(a,b){var c=this;return 1===arguments.length?(Object.each(arguments[0],function(a,b){c.addHelper(b,a)}),void 0):(c._helpers[a]=b,void 0)},addPartial:function(a,b){var c=this;return 1===arguments.length?(Object.each(arguments[0],function(a,b){c.addPartial(b,a)}),void 0):(c._partials[a]=b,void 0)},addChunk:function(a,b){var c=this;c._chunks[a]=b},compile:function(a){var b=this;a&&(b._init(),b._template=h.compile(b,a))},getHtml:function(){var a=this;return a._html},getNodeList:function(){var a=this;return a._nodeList.slice(0)},_wrap:function(a){var b,c,d=this,e=d._name,f=d._id,h=e+"/"+f,i=d._type,j=g.createElement("template");j.innerHTML=a,b=j.firstElementChild,c=j.lastElementChild,b||(b=g.createElement("template"),j.firstChild?j.insertBefore(b,j.firstChild):j.appendChild(b)),c||(c=g.createElement("template"),j.appendChild(c)),b.setAttribute(i+"-begin",h),c.setAttribute(i+"-end",h),d._html=j.innerHTML,d._nodeList=[],Object.each(j.childNodes,function(a){d._nodeList.push(a)})},all:function(a){var b,c=this,d=c._root,f=c._helpers,a=(c._name,a||c._data);return c._data=a,d instanceof h&&(f=Object.extend({},d._helpers,f)),b=c._template(a,{helpers:f}),c._template2=e.compile(b),b=c._template2({},{partials:c._partials}),c._wrap(b),c._html},_replace:function(){var a,b,c,d,e=this,f=e._name,h=e._id,i=e._type,j=e._nodeList,k=g.createDocumentFragment();for(a=g.querySelector("*["+i+'-begin="'+f+"/"+h+'"]'),b=g.querySelector("*["+i+'-end="'+f+"/"+h+'"]'),d=a.parentNode||b.parentNode;a!==b;)c=a.nextElementSibling,d.removeChild(a),a=c;Object.each(j,function(a){k.appendChild(a)}),d.insertBefore(k,b),d.removeChild(b)},update:function(a,b){var c,d,e,f,h,i=this;return g.createElement("template"),c="string"==typeof a?a.split(/[.\/]/g):a,c.length?(e=c[0],d=i._chunks[e],d?(i._partials[e]=d.update(c.slice(1),b),i._html=i._template2({},{partials:i._partials})):(f=i._data,h=c.pop(),Object.each(c,function(a){f=f[a]}),f[h]=b,i.all(),i._replace())):(f=i._data,Object.keys(f).length!==Object.keys(b).length&&(b=Object.extend({},f,b)),i.all(b),i._replace()),i._html},destroy:function(){var a=this,b=a._chunks;Object.each(b,function(a){a.destroy()}),delete a._template,delete a._template2,delete a._data,delete a._chunks}}),i=/(\{\{#chunk\s+[^}\s]+\s*[^}]*\}\})|(\{\{\/chunk\}\})/g,j=/\{\{#chunk\s+([^}\s]+)\s*\}\}/,k=/\{\{\/chunk\}\}/,l=1;h.id=function(){return l++},h.helpers=function(a){a.addHelper("chunk",function(b){var c;return c=a._chunks[b],a._partials[b]=c.all(this),new e.SafeString("{{> "+b+"}}")})},h.partials=function(){},h.chunks=function(){},h.compile=function(a,b){var c,d=[],f=[];return c=b.match(i),c&&c.forEach(function(c){var g,i,l,m,n,o,p,q,r,s,t,u;i=c.match(k),i?(g=d.pop(),p=f.pop(),q=f.length?f[f.length-1]:a,l=g[0],m=i[0],t=g[1],n=b.indexOf(l),o=b.indexOf(m),r=b.substring(0,n),u=b.substring(n+l.length,o),s=b.substring(o+m.length),b=r+"{{#with "+t+'}}{{chunk "'+t+'"}}{{/with}}'+s,p._name=t,p._root=q,p._type="chunk",p._template=e.compile(u),q.addChunk(t,p)):(g=c.match(j),d.push(g),q=new h,q._init(),f.push(q))}),e.compile(b)},c.exports=h});